<!DOCTYPE html>
<html lang="zh-cn">

<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="/drafts/user-common-plugin.html" />

    <title>  愚钝的故事 &mdash; 微信用户的设计
</title>




    <link rel="stylesheet" href="/theme/css/style.css">

    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->


    <meta name="author" content="Jet Geng">
  <meta name="tags" contents="">
</head>

<body>
<header class="header">
  <div class="container">
    <div class="header-inner">
      <h1 class="header-name">
        <a class="nodec" href="/">愚钝的故事</a>
      </h1>
      <h3 class="header-text">Jet Geng的工作和生活</h3>
      <ul class="header-menu list-inline">
          <li><a class="nodec icon-github" href="https://github.com/jetgeng"></a></li>
      </ul>
    </div>
  </div>
</header> <!-- /.header -->  <div class="container">
  <div class="post full-post">
    <h1 class="post-title">
      <a href="/drafts/user-common-plugin.html" title="Permalink to 微信用户的设计">微信用户的设计</a>
    </h1>
    <ul class="list-inline">
      <li class="post-date">
        <a class="text-muted" href="/drafts/user-common-plugin.html" title="2015-04-30T18:03:00+08:00">Thu 30 April 2015</a>
      </li>
      <li class="muted">&middot;</li>
      <li class="post-category">
        <a href="/category/she-ji.html">设计</a>
      </li>
        <li class="muted">&middot;</li>
        <li>
          <address class="post-author">
            By <a href="/author/jet-geng.html">Jet Geng</a>
          </address>
        </li>
    </ul>
    <div class="post-content">
      <div class="section" id="validate">
<h2>让客户端能够接受微信的validate</h2>
<div class="section" id="id2">
<h3>当前的问题</h3>
<p>对于存在于数据库的用户，没有问题。但是现在微信中存在，但是在我们的数据库中不存在的用户，怎么办。 这个时候用户一定已经有了。
我们只是需要让他做关联。要做的内容：</p>
<ol class="arabic simple">
<li>修改spring-security-cas的内容。要求能够创建新的UserDetail.  现在使用的是  GormUserDetailsService</li>
<li>通过新建不同的Authentication 来处理这件事情。</li>
</ol>
<p>当前系统中支持三种class：</p>
<img alt="uml diagram" class="uml" src="/images/5e333a9b.png" />
<p>现在最核心的问题是AbstractCasAssertionUserDetailsService 这个类，也就是获取用户信息的方法。如果我只是换取一个这个方法，就解决了。</p>
<p>这么一来就简单了。只需要建立一个proxy这样的东西就好了。
我如何来调试这个呢？我们的cas使用的是一个叫做 AssertionImpl 这样的东西。</p>
</div>
</div>

    </div>
  </div>
  <hr class="separator">
  <div class="col-md-8 col-md-offset-2">
  <div id="disqus_thread">
    <script>
      var disqus_shortname = 'techfoolishstory';
      (function() {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] ||
         document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>
      Please enable JavaScript to view the
      <a href="https://disqus.com/?ref_noscript=techfoolishstory">
        comments powered by Disqus.
      </a>
    </noscript>
    <a href="https://disqus.com" class="dsq-brlink">
      blog comments powered by <span class="logo-disqus">Disqus</span>
    </a>
  </div>
  </div>
  </div>
<footer class="footer">
  <div class="container">
    <p class="text-center">
      Jet Geng, <a href="" target="_blank">版权归Jet Geng所有，转载请注明！</a> unless otherwise noted.
    </p>
    <div class="text-center">
      Generated by <a href="http://getpelican.com" target="_blank">Pelican</a> with the <a href="http://github.com/nairobilug/pelican-alchemy">alchemy</a> theme.
    </div>
  </div>
</footer> <!-- /.footer -->
  <script src="/theme/js/jquery.min.js"></script>
  <script src="/theme/js/bootstrap.min.js"></script>
</body> <!-- 42 -->

</html>